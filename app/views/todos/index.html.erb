<script>
  function toggleCompleted() {
    visible = localStorage.getItem("rails_todo_application:completed_visible");
    if (visible === "true") {
      document.querySelector("#completed_todos").style.visibility = "hidden";
      localStorage.setItem("rails_todo_application:completed_visible", "false");
    } else {
      document.querySelector("#completed_todos").style.visibility = "visible";
      localStorage.setItem("rails_todo_application:completed_visible", "true");
    }
  }

  function toggleTheme() {
    visible = localStorage.getItem("rails_todo_application:dark_theme_enabled");
    if (visible === "true") {
      document.querySelector("html").classList.add("dark");
      localStorage.setItem("rails_todo_application:dark_theme_enabled", "true");
    } else {
      document.querySelector("html").classList.remove("dark");
      localStorage.setItem("rails_todo_application:dark_theme_enabled", "false");
    }
  }
</script>

<% if notice != nil %>
  <div id="notice" class="fixed bg-green-500 px-2 py-1 w-full text-white text-sm h-fit flex flex-row" id="notice">
    <p class="ml-1 text-sm mr-auto">
      <%= notice %>
    </p>
    <button class="mr-1 ml-auto hover:text-gray-100" onclick="document.querySelector('#notice').remove()">Close</button>
  </div>
<% end %>

<div class="px-[30%] py-[5%] w-full h-full space-y-6 dark:bg-gray-900">
  <div class="flex flex-row space-x-2 dark:bg-gray-900">
    <button onclick="toggleCompleted()" class="rounded-lg px-2 py-1 text-sm bg-gray-50 text-black block mt-auto hover:bg-gray-100 duration-75 dark:bg-gray-700 dark:hover:bg-gray-800 dark:text-white">Toggle Uncompleted</button>

    <button onclick="toggleTheme()" class="rounded-lg px-2 py-1 text-sm bg-gray-50 text-black block mt-auto hover:bg-gray-100 duration-75 dark:bg-gray-700 dark:hover:bg-gray-800 dark:text-white">
      Toggle Light/Dark
    </button>
  </div>

  <div class="space-y-16 dark:bg-gray-900">
    <div id="todos" class="space-y-3">
      <div class="flex justify-between items-center">
        <h1 class="font-bold text-4xl dark:text-white">Uncompleted Todos</h1>
        <%= link_to 'New', new_todo_path, class: "rounded-lg px-2 py-1 text-sm bg-blue-600 text-white block mt-auto hover:bg-blue-700 duration-75" %>
      </div>

      <hr/>
    
      <div id="todos" class="w-full space-y-4">
        <%= render @todos, completed: false %>
      </div>
    </div>

    <div id="completed_todos" class="space-y-3" data-opened="false">
      <div class="flex justify-between items-center">
        <h1 class="font-bold text-4xl dark:text-white">Completed Todos</h1>
      </div>

      <hr/>
    
      <div id="todos" class="w-full space-y-4">
        <%= render @completed_todos, completed: true %>
      </div>
    </div>
  </div>
</div>
